<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Nieberg.nl</title>
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script type="text/javascript" src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="js/three.min.js"></script>
    <script type="text/javascript" src="js/tween.min.js"></script>
    <script type="text/javascript" src="js/stats.min.js"></script>
    <script type="text/javascript" src="js/gameState.js"></script>

	<style>
		html, input[type=text], input[type=text] {
			font-family: Arial;
			font-size: 11px;
		}
		#map, #view {
			float: left;
		}
		#view, #canvas, #coordinates, #debug {
			margin: 0 10px 10px 0;
		}
	</style>
</head>
<body style="background:#000000;">
	<div id="map">
		<canvas id="canvas"></canvas><br>
		<input type="text" id="coordinates" value="" style="width:300px;"><input type="button" id="reset-game" value="Reset"><br>
		<p style="color: #fff;" id="debug"></p>
	</div>
	<div id="view"></div>
</body>
<script type="x-shader/x-fragment" id="fragmentShaderDepth">

	uniform sampler2D texture;
	varying vec2 vUV;

	vec4 pack_depth( const in float depth ) {

		const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );
		const vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );
		vec4 res = fract( depth * bit_shift );
		res -= res.xxyz * bit_mask;
		return res;

	}

	void main() {

		vec4 pixel = texture2D( texture, vUV );

		if ( pixel.a < 0.5 ) discard;

		gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );

	}
</script>

<script type="x-shader/x-vertex" id="vertexShaderDepth">

	varying vec2 vUV;

	void main() {

		vUV = 0.75 * uv;

		vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

		gl_Position = projectionMatrix * mvPosition;

	}

</script>
<script type="text/javascript" src="js/dungeon.js"></script>
<script type="text/javascript" src="js/threedee.js"></script>
<script type="text/javascript">
$(window).on('beforeunload', function() {
	saveGame(0, 'autosave');
});
</script>
</html>
